§SQLWhere§=§((InfoVisites.NoStatut)=4)§§SQLStatement§=§SELECT Utilisateurs.Nom + ',' + Utilisateurs.Prenom AS [Thérapeute],CodificationsDossiers.Nom, Sum(StatFactures.MontantFacture) as SumMontant FROM (CodificationsDossiers INNER JOIN InfoFolders ON CodificationsDossiers.NoCodification = InfoFolders.NoCodification) INNER JOIN ((InfoVisites INNER JOIN Utilisateurs ON InfoVisites.NoTRP = Utilisateurs.NoUser) INNER JOIN StatFactures ON InfoVisites.NoFacture = StatFactures.NoFacture) ON InfoFolders.NoFolder = InfoVisites.NoFolder WHEREGEN GROUP BY Utilisateurs.Nom + ',' + Utilisateurs.Prenom, CodificationsDossiers.Nom ORDER BY [Thérapeute], CodificationsDossiers.Nom;§§ColsFormat§=§{SumMontant=CURRENCY£Revenu moyen=CURRENCY}§§StyleFileName§=§###CLINICAPATH###Data\Rapports\basicbody.css§§TotalPosition§=§BOTH§§ExtraColumnsSQL§=§SELECT CASE WHEN COUNT(NoVisite) = 0 THEN 0 ELSE SUM(MontantFacture)/COUNT(NoVisite) END as [Revenu moyen] FROM ( SELECT Utilisateurs.Nom + ',' + Utilisateurs.Prenom AS [Thérapeute],InfoVisites.NoVisite,SUM(MontantFacture) as MontantFacture FROM         CodificationsDossiers INNER JOIN                       InfoFolders ON CodificationsDossiers.NoCodification = InfoFolders.NoCodification INNER JOIN                       InfoVisites INNER JOIN                       Utilisateurs ON InfoVisites.NoTRP = Utilisateurs.NoUser ON InfoFolders.NoFolder = InfoVisites.NoFolder INNER JOIN                       StatFactures ON InfoVisites.NoFacture = StatFactures.NoFacture WHEREGEN GROUP BY Utilisateurs.Nom + ',' + Utilisateurs.Prenom,InfoVisites.NoVisite) AS Stats GROUP BY [Thérapeute] UNION ALL SELECT CASE WHEN COUNT(NoVisite) = 0 THEN 0 ELSE SUM(MontantFacture)/COUNT(NoVisite) END as [Revenu moyen] FROM ( SELECT     InfoVisites.NoVisite, SUM(StatFactures.MontantFacture) AS MontantFacture FROM         CodificationsDossiers INNER JOIN                       InfoFolders ON CodificationsDossiers.NoCodification = InfoFolders.NoCodification INNER JOIN                       InfoVisites ON InfoFolders.NoFolder = InfoVisites.NoFolder INNER JOIN                       StatFactures ON InfoVisites.NoFacture = StatFactures.NoFacture WHEREGEN GROUP BY InfoVisites.NoVisite) AS Stats §§ExtraColumnsSQLWhere§=§(((InfoVisites.NoStatut) = 4))§